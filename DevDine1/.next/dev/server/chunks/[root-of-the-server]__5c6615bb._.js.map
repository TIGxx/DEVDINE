{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Devdinev1/lib/supabase/server.ts"],"sourcesContent":["import { createServerClient } from \"@supabase/ssr\"\nimport { cookies } from \"next/headers\"\n\nexport async function createClient() {\n  const cookieStore = await cookies()\n\n  return createServerClient(process.env.NEXT_PUBLIC_SUPABASE_URL!, process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!, {\n    cookies: {\n      getAll() {\n        return cookieStore.getAll()\n      },\n      setAll(cookiesToSet) {\n        try {\n          cookiesToSet.forEach(({ name, value, options }) => cookieStore.set(name, value, options))\n        } catch {\n          // The \"setAll\" method was called from a Server Component.\n          // This can be ignored if you have middleware refreshing\n          // user sessions.\n        }\n      },\n    },\n  })\n}\n"],"names":[],"mappings":";;;;AAAA;AAAA;AACA;;;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,4IAAO;IAEjC,OAAO,IAAA,iMAAkB,EAAC,QAAQ,GAAG,CAAC,wBAAwB,EAAG,QAAQ,GAAG,CAAC,6BAA6B,EAAG;QAC3G,SAAS;YACP;gBACE,OAAO,YAAY,MAAM;YAC3B;YACA,QAAO,YAAY;gBACjB,IAAI;oBACF,aAAa,OAAO,CAAC,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,OAAO,EAAE,GAAK,YAAY,GAAG,CAAC,MAAM,OAAO;gBAClF,EAAE,OAAM;gBACN,0DAA0D;gBAC1D,wDAAwD;gBACxD,iBAAiB;gBACnB;YACF;QACF;IACF;AACF","debugId":null}},
    {"offset": {"line": 78, "column": 0}, "map": {"version":3,"sources":["file:///C:/Devdinev1/app/api/orders/route.ts"],"sourcesContent":["import { type NextRequest, NextResponse } from \"next/server\"\nimport { createClient } from \"@/lib/supabase/server\"\n\nexport async function POST(request: NextRequest) {\n  try {\n    const { customerName, customerEmail, orderType, paymentMethod, items, totalAmount } = await request.json()\n\n    if (!customerName || !customerEmail || !orderType || !paymentMethod || !items || !totalAmount) {\n      return NextResponse.json({ error: \"Missing required fields\" }, { status: 400 })\n    }\n\n    const supabase = await createClient()\n\n    const { data: queueData, error: queueError } = await supabase\n      .from(\"queue_counter\")\n      .select(\"current_number, last_reset_date\")\n      .eq(\"id\", 1)\n      .maybeSingle()\n\n    if (queueError) {\n      console.error(\"[v0] Error fetching queue counter:\", queueError)\n      return NextResponse.json({ error: \"Failed to generate queue number\" }, { status: 500 })\n    }\n\n    const today = new Date().toISOString().split(\"T\")[0]\n    let queueNumber = 1\n\n    // If no queue counter exists, initialize it\n    if (!queueData) {\n      console.log(\"[v0] Initializing queue counter\")\n      const { error: insertError } = await supabase.from(\"queue_counter\").insert({\n        id: 1,\n        current_number: 1,\n        last_reset_date: today,\n      })\n\n      if (insertError) {\n        console.error(\"[v0] Error initializing queue counter:\", insertError)\n        return NextResponse.json({ error: \"Failed to initialize queue number\" }, { status: 500 })\n      }\n    } else {\n      // Calculate next queue number\n      queueNumber = queueData.current_number + 1\n\n      // Reset queue number if it's a new day\n      if (queueData.last_reset_date !== today) {\n        queueNumber = 1\n      }\n\n      // Update queue counter\n      const { error: updateError } = await supabase\n        .from(\"queue_counter\")\n        .update({\n          current_number: queueNumber,\n          last_reset_date: today,\n        })\n        .eq(\"id\", 1)\n\n      if (updateError) {\n        console.error(\"[v0] Error updating queue counter:\", updateError)\n        return NextResponse.json({ error: \"Failed to update queue number\" }, { status: 500 })\n      }\n    }\n\n    // Create order\n    const { data: orderData, error: orderError } = await supabase\n      .from(\"orders\")\n      .insert({\n        queue_number: queueNumber,\n        customer_name: customerName,\n        customer_email: customerEmail,\n        order_type: orderType,\n        payment_method: paymentMethod,\n        total_amount: totalAmount,\n      })\n      .select()\n      .single()\n\n    if (orderError) {\n      console.error(\"[v0] Error creating order:\", orderError)\n      return NextResponse.json({ error: \"Failed to create order\" }, { status: 500 })\n    }\n\n    // Create order items\n    const orderItems = items.map((item: any) => ({\n      order_id: orderData.id,\n      item_name: item.name,\n      item_price: item.price,\n      quantity: item.quantity,\n    }))\n\n    const { error: itemsError } = await supabase.from(\"order_items\").insert(orderItems)\n\n    if (itemsError) {\n      console.error(\"[v0] Error creating order items:\", itemsError)\n      return NextResponse.json({ error: \"Failed to create order items\" }, { status: 500 })\n    }\n\n    console.log(\"[v0] Order created successfully:\", orderData.id)\n\n    return NextResponse.json({\n      success: true,\n      orderId: orderData.id,\n      queueNumber: queueNumber,\n    })\n  } catch (error) {\n    console.error(\"[v0] Error processing order:\", error)\n    return NextResponse.json({ error: \"Failed to process order\" }, { status: 500 })\n  }\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}